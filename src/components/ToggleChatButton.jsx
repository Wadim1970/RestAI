import React, { useState } from 'react'; // Подключаем библиотеку React и хук useState для управления состоянием

/**
 * Кнопка переключения режимов (Голос / ИИ-Чат)
 * Эти пути указывают на папку public/icons/. 
 * Браузер ищет их в корневой директории сборки.
 */
const AudioIconSrc = '/icons/free-icon-audio.png'; // Переменная с путем к иконке микрофона
const ChatIconSrc = '/icons/free-icon-chat.png';   // Переменная с путем к иконке чата

// Основной компонент кнопки, принимает пропс onToggle (функцию из родителя App.jsx)
const ToggleChatButton = ({ onToggle }) => {
  
  // Создаем переменную состояния 'mode'. 
  // 'voice' — это начальное значение (экран с видео-аватаром).
  const [mode, setMode] = useState('voice'); 

  // Функция, которая запускается при клике по кнопке
  const handleToggle = () => {
    
    // Вычисляем новый режим: если был 'voice' — станет 'chat', если был 'chat' — станет 'voice'
    const newMode = mode === 'voice' ? 'chat' : 'voice';
    
    // Обновляем состояние кнопки, чтобы она перерисовала иконку
    setMode(newMode);
    
    // Если родительский компонент передал функцию onToggle, вызываем её с новым режимом
    // Это нужно, чтобы App.jsx узнал, что пора открывать или закрывать модалку чата
    if (onToggle) {
      onToggle(newMode);
    }
  };

  /**
   * РЕНДЕР КНОПКИ
   * Здесь решается, какая иконка будет внутри в зависимости от mode
   */
  return (
    <button 
      className="toggle-chat-button" // Класс для внешних стилей из styles.css
      onClick={handleToggle}         // Привязываем функцию handleToggle к событию клика
      type="button"                  // Явно указываем тип кнопки (чтобы не сработал submit в формах)
      style={{
        display: 'flex',             // Включаем гибкую верстку для центрирования
        justifyContent: 'center',    // Центрируем содержимое по горизонтали
        alignItems: 'center',        // Центрируем содержимое по вертикали
        padding: 0,                  // Убираем внутренние отступы, чтобы не ломать размеры
        backgroundColor: '#48BF48',  // Твой фирменный зеленый цвет фона
        borderRadius: '50%',         // Делаем кнопку идеально круглой
        border: 'none',              // Убираем стандартную рамку браузера
        cursor: 'pointer'            // Меняем курсор на "руку" при наведении
      }}
    >
      {/* ПРОВЕРКА УСЛОВИЯ: Если режим 'voice' (смотрим видео) */}
      {mode === 'voice' ? (
        
        /* 1. ВАРИАНТ ПРИ СТАРТЕ: Рисуем иконку ЧАТА, чтобы войти в него */
        <img 
          src={ChatIconSrc}          // Источник: иконка облачка чата
          key="chat-img"             // Уникальный ключ для React, чтобы смена иконок была плавной
          className="chat-icon-img"  // Класс для возможной доп. стилизации
          alt="Switch to Chat"       // Текст для экранных читалок (доступность)
          style={{ 
            width: '7.05vw',         // Твой размер 31px (в расчете на экран 440px)
            height: '7.05vw',        // Квадратная форма иконки
            objectFit: 'contain',    // Вписываем картинку в границы без искажений
            filter: 'brightness(0) invert(1)' // Фокус: превращаем темную иконку в БЕЛУЮ
          }} 
        />
      ) : (
        
        /* 2. ВАРИАНТ, КОГДА ЧАТ ОТКРЫТ: Рисуем иконку АУДИО, чтобы вернуться */
        <img 
          src={AudioIconSrc}         // Источник: иконка микрофона
          key="audio-img"            // Ключ для смены элемента
          className="audio-icon-img" // Класс для иконки аудио
          alt="Switch to Voice"      // Описание
          style={{ 
            width: '9.09vw',         // Твой размер 40px по ширине
            height: '7.95vw',        // Твой размер 35px по высоте
            objectFit: 'contain',    // Вписываем в размеры
            filter: 'brightness(0) invert(1)' // Также делаем иконку БЕЛОЙ
          }}
        />
      )}
    </button>
  );
};

export default ToggleChatButton; // Экспортируем компонент для использования в MainScreen.jsx
